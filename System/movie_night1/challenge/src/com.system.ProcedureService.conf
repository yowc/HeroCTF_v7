<!DOCTYPE busconfig PUBLIC
 "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">
<busconfig>
  <!-- Define the service -->
  <policy user="root">
    <allow own="com.system.ProcedureService"/>
  </policy>

  <!-- Allow user, dev, and admin to call methods on the service -->
  <policy user="user">
    <allow send_destination="com.system.ProcedureService"/>
    <allow receive_sender="com.system.ProcedureService"/>
  </policy>

  <policy user="dev">
    <allow send_destination="com.system.ProcedureService"/>
    <allow receive_sender="com.system.ProcedureService"/>
  </policy>

  <policy user="admin">
    <allow send_destination="com.system.ProcedureService"/>
    <allow receive_sender="com.system.ProcedureService"/>
  </policy>

  <!-- Deny everyone else -->
  <policy context="default">
    <deny send_destination="com.system.ProcedureService"/>
    <deny receive_sender="com.system.ProcedureService"/>
  </policy>
</busconfig>

